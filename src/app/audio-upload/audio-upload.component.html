<section class="section">
  <div class="container upload">
    <form class="upload-form" [formGroup]="audioUpload" (ngSubmit)="onSubmit()">
      <div class="input-container">
        <label for="topic">Topic</label>
        <input maxlength="50" placeholder="Enter Topic name" type="text" name="topic" id="topic" formControlName="topic">
        <span *ngIf="topic?.touched && topic?.invalid" class="error-msg">Topic is required!</span>
      </div>
      
      <div class="input-container">
        <label for="speaker">Speaker</label>
        <input maxlength="40" placeholder="Enter Speaker name" type="text" name="speaker" id="speaker" formControlName="speaker">  
        <span *ngIf="speaker?.touched && speaker?.invalid" class="error-msg">Speaker is required!</span>
      </div>
      
      <div class="input-container">
        <label for="tags">Tags</label>
        <input
          placeholder="Enter Tags separated by comma (,)" 
          type="text" 
          name="tags" 
          id="tags" 
          (input)="onInput($event)"
          (keydown)="onKeyDown($event)"
          (blur)="addTag()"
          (paste)="onPaste($event)"
          #tagsInput
        >
        <div class="tags-container" *ngIf="tagList.length > 0">
          <div class="tag" *ngFor="let tag of tagList; let i = index">
            <span class="tag-text">{{ tag }}</span>
            <button class="tag-remove" (click)="removeTag(i)" type="button">
              <svg width="12" height="12" viewBox="0 0 12 12" fill="none">
                <path d="M9 3L3 9M3 3L9 9" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
              </svg>
            </button>
          </div>
        </div>
        <span *ngIf="tags?.touched && tags?.invalid && tagList.length === 0" class="error-msg">Tags are required!</span>
      </div>
    
      <div class="input-container">
        <label for="description">Description</label>
        <textarea cols="30" rows="4" maxlength="150" placeholder="Enter description" name="description" id="description" formControlName="description"></textarea>  
        <span *ngIf="description?.touched && description?.invalid" class="error-msg">Description is required!</span>
      </div>

      <div class="upload-container">
        <!-- Image Upload -->
        <div class="input-container">
          <label for="image-file">Upload Thumbnail image</label>
          <div class="file-upload-form">
            <label *ngIf="!hasFile('image')"
              for="image-file" 
              class="file-upload-label"
              [class.dragover]="isDragOver('image')"
              [class.has-file]="hasFile('image')"
              (dragover)="onDragOver($event, 'image')"
              (dragleave)="onDragLeave($event, 'image')"
              (drop)="onDrop($event, 'image')">
              
              <div class="file-upload-design" *ngIf="!hasFile('image')">
                <svg viewBox="0 0 640 512" height="1em">
                  <path d="M144 480C64.5 480 0 415.5 0 336c0-62.8 40.2-116.2 96.2-135.9c-.1-2.7-.2-5.4-.2-8.1c0-88.4 71.6-160 160-160c59.3 0 111 32.2 138.7 80.2C409.9 102 428.3 96 448 96c53 0 96 43 96 96c0 12.2-2.3 23.8-6.4 34.6C596 238.4 640 290.1 640 352c0 70.7-57.3 128-128 128H144zm79-217c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l39-39V392c0 13.3 10.7 24 24 24s24-10.7 24-24V257.9l39 39c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-80-80c-9.4-9.4-24.6-9.4-33.9 0l-80 80z"></path>
                </svg>
                <p>Drag and Drop Image</p>
                <p>or</p>
                <span class="btn btn--full browse-button">Browse file</span>
              </div>
              
              <input 
                id="image-file" 
                type="file" 
                accept="image/*"
                (change)="onFileSelected($event, 'image')"/>
            
            </label>

            <!-- Image File Info -->
            <div class="file-info" *ngIf="hasFile('image')">
              <div class="file-name"><strong>Name: </strong> {{ getFileInfo('image')?.name }}</div>
              <div class="file-size"><strong>Size: </strong> {{ getFileInfo('image')?.size }}</div>
              <div class="preview-container" *ngIf="getFileInfo('image')?.preview">
                <img 
                  class="image-preview" 
                  [src]="getFileInfo('image')?.preview" 
                  alt="Image preview" />
              </div>
              <div class="file-actions">
                <button 
                  type="button" 
                  class="btn btn--cancel remove-file" 
                  (click)="removeFile('image')">
                  Remove
                </button>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Audio Upload -->
        <div class="input-container">
          <label for="audio-file">Upload Audio file</label>
          <div class="file-upload-form">
            <label *ngIf="!hasFile('audio')"
              for="audio-file" 
              class="file-upload-label"
              [class.dragover]="isDragOver('audio')"
              [class.has-file]="hasFile('audio')"
              (dragover)="onDragOver($event, 'audio')"
              (dragleave)="onDragLeave($event, 'audio')"
              (drop)="onDrop($event, 'audio')">
              
              <div class="file-upload-design" *ngIf="!hasFile('audio')">
                <svg viewBox="0 0 640 512" height="1em">
                  <path d="M144 480C64.5 480 0 415.5 0 336c0-62.8 40.2-116.2 96.2-135.9c-.1-2.7-.2-5.4-.2-8.1c0-88.4 71.6-160 160-160c59.3 0 111 32.2 138.7 80.2C409.9 102 428.3 96 448 96c53 0 96 43 96 96c0 12.2-2.3 23.8-6.4 34.6C596 238.4 640 290.1 640 352c0 70.7-57.3 128-128 128H144zm79-217c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l39-39V392c0 13.3 10.7 24 24 24s24-10.7 24-24V257.9l39 39c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-80-80c-9.4-9.4-24.6-9.4-33.9 0l-80 80z"></path>
                </svg>
                <p>Drag and Drop Audio file</p>
                <p>or</p>
                <span class="btn btn--full browse-button">Browse file</span>
              </div>
              
              <input 
                id="audio-file" 
                type="file" 
                accept="audio/*"
                (change)="onFileSelected($event, 'audio')"/>
            </label>

            <!-- Audio File Info -->
            <div class="file-info" *ngIf="hasFile('audio')">
              <div class="file-name">{{ getFileInfo('audio')?.name }}</div>
              <div class="file-size">{{ getFileInfo('audio')?.size }}</div>
              <div class="preview-container audio-preview" *ngIf="getFileInfo('audio')?.preview">
                <audio controls [src]="getFileInfo('audio')?.preview">
                  Your browser does not support the audio element.
                </audio>
              </div>
              <div class="file-actions">
                <button 
                  type="button" 
                  class="btn btn--cancel remove-file" 
                  (click)="removeFile('audio')">
                  Remove
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <button 
        class="btn btn--full" 
        type="submit"
        [disabled]="isFormValid()">
        Save
      </button>
    </form>
  </div>
</section>